## 1.添加手机用户

```sql
insert into WP_POS_USERS(USER_ID,USER_NAME,USER_PWD,KHDM,CJR,CJRQ,UUID,YQY,QYR,QYRQ)
select khdm,khmc,'8888',khdm,'sa',GETDATE(),'',1,'sa',GETDATE() from KEHU
```

## 2.MS 升级 E3

```SQL
/********************************商品资料******************************************/
---导入颜色
  delete [E3_YHM_2022]..YANSE
  INSERT INTO YANSE(YSDM,YSMC)
  SELECT ysdm,ysmc from MS..yanse  where ysdm not in(select ysdm from [E3_YHM_2022]..yanse)
--尺码
  delete  [E3_YHM_2022]..chima
  INSERT INTO [E3_YHM_2022]..CHIMA(CMDM,CMMC,CWZ,LWZ,CMDZ)
  SELECT CMDM,CMMC,CWZ,LWZ,ZJF from MS..CHIMA  where CMDM not in(select CMDM from [E3_YHM_2022]..CHIMA)
  SELECT * FROM CHIMAZU
  --尺码组
  INSERT INTO [E3_YHM_2022]..CHIMAZU(CMZDM,CMZMC,TY)
  SELECT CMZDM,CMZMC,TY FROM MS..CHIMAZU
  --尺码组明细
  INSERT INTO [E3_YHM_2022]..CHIMAZUmx(CMZDM,CMDM)
  SELECT CMZDM,cmdm FROM MS..CHIMAZUMX
  --品牌
  delete [E3_YHM_2022]..PINPAI
  insert into [E3_YHM_2022]..PINPAI(PPDM,PPMC,BYZD1)
  select ppdm,ppmc,byzd1 from MS..PINPAI where PPDM not in(select PPDM from [E3_YHM_2022]..PINPAI)
  --大类
  delete [E3_YHM_2022]..DALEI
  insert into [E3_YHM_2022]..DALEI(DLDM,DLMC)
  select zldm,zlmc from MS..HPZL where ZLDM  not in(SELECT dldm from [E3_YHM_2022]..DALEI)
  --年份
  DELETE [E3_YHM_2022]..NIANFEN
  INSERT INTO [E3_YHM_2022]..NIANFEN(NFDM,NFMC)
  SELECT NFDM,NFMC FROM  MS..HPNF WHERE NFDM NOT IN(SELECT NFDM FROM [E3_YHM_2022]..NIANFEN)
  --季节
  DELETE [E3_YHM_2022]..JIJIE
  INSERT INTO [E3_YHM_2022]..JIJIE(JJDM,JJMC)
  SELECT JJDM,JJMC FROM MS..JIJIE WHERE JJDM NOT IN(SELECT JJDM FROM [E3_YHM_2022]..JIJIE)
  --款式
  DELETE [E3_YHM_2022]..SPSX1
  INSERT INTO [E3_YHM_2022]..SPSX1(SXDM,SXMC)
  SELECT KSDM,KSMC FROM MS..HPKS WHERE KSDM NOT IN(SELECT SXDM FROM [E3_YHM_2022]..SPSX1)
---导入资料
  delete [E3_YHM_2022]..HPXX
  INSERT INTO [E3_YHM_2022]..HPXX(HPDM,HPMC,ZJF,DLDM,JJDM,PPDM,NFDM,BYSX1,JJ,SJ,SJ1,SJ3,SJ4,TY,TJ,S_RQ,E_RQ,CJR,CJRQ,BYZD1,FJSX1,FJSX2,FJSX3,FJSX4,FJSX5,FJSX6,KCSX,KCXX  )
  SELECT  HPDM,HPMC,ZJF,'000','000','000','000','000',JJ,SJ1,SJ3,SJ,SJ2,TY,TJ,S_RQ,S_RQ,'sa',GETDATE(),BYZD1,FJSX1,FJSX2,FJSX3,FJSX4,FJSX5,FJSX6,KCSX,KCXX FROM MS..HPXX
  WHERE HPDM NOT IN(SELECT HPDM FROM [E3_YHM_2022]..HPXX)
  ---更新价格
  UPDATE  HPXX SET SJ5=0,SJ6=0,SJ7=0,SJ8=0,SJ9=0,SJ2=0

  ---导入颜色
  delete [E3_YHM_2022]..HPYS
  INSERT INTO [E3_YHM_2022]..HPYS(HPDM,YSDM)
  SELECT HPDM,YSDM FROM MS..HPYS WHERE  HPDM+YSDM NOT IN(SELECT HPDM+YSDM FROM HPYS) AND YSDM IN(SELECT YSDM FROM [E3_YHM_2022]..YANSE) AND HPDM IN(SELECT HPDM FROM [E3_YHM_2022]..HPXX)
---导入尺码
  delete [E3_YHM_2022]..hpcm
  INSERT INTO [E3_YHM_2022]..HPCM(HPDM,CMDM)
  SELECT HPDM,CMDM FROM MS..HPCM WHERE  HPDM+CMDM NOT IN(SELECT HPDM+CMDM FROM HPCM) AND CMDM IN(SELECT CMDM FROM [E3_YHM_2022]..CHIMA) AND HPDM IN(SELECT HPDM FROM [E3_YHM_2022]..HPXX)
---品牌
  UPDATE  A SET A.PPDM=B.PPDM FROM [E3_YHM_2022]..HPXX A,(SELECT  HPDM,B.PPDM FROM  MS..V_HPXX A ,[E3_YHM_2022]..PINPAI B WHERE  A.PPMC=B.PPMC) B WHERE A.HPDM=B.HPDM
---大类
  UPDATE  A SET A.DLDM=B.DLDM FROM [E3_YHM_2022]..HPXX A,(SELECT  HPDM,B.DLDM FROM  MS..V_HPXX A ,[E3_YHM_2022]..DALEI B WHERE  A.ZLMC=B.DLMC) B WHERE A.HPDM=B.HPDM
  --jijie
  UPDATE  A SET A.JJDM=B.JJDM FROM [E3_YHM_2022]..HPXX A,(SELECT  HPDM,B.JJDM FROM  MS..V_HPXX A ,[E3_YHM_2022]..JIJIE B WHERE  A.JJMC=B.JJMC) B WHERE A.HPDM=B.HPDM
--nianfen
  UPDATE  A SET A.NFDM=B.NFDM FROM [E3_YHM_2022]..HPXX A,(SELECT  HPDM,B.NFDM FROM  MS..V_HPXX A ,[E3_YHM_2022]..NIANFEN B WHERE  A.NFMC=B.NFMC) B WHERE A.HPDM=B.HPDM
---kuanse
  UPDATE  A SET A.bysx1=B.SXDM FROM [E3_YHM_2022]..HPXX A,(SELECT  HPDM,B.SXDM FROM  MS..V_HPXX A ,[E3_YHM_2022]..SPSX1 B WHERE  A.KSMC=B.SXMC) B WHERE A.HPDM=B.HPDM
/********************************销售资料*********************************************/
  ---员工
  delete [E3_YHM_2022]..YUANGONG
  insert into [E3_YHM_2022]..YUANGONG(YGDM,YGMC)
  values('000','未定义')
  --区域
  delete FROM MS..QUYU
  INSERT INTO QUYU(QYDM,QYMC,BYZD1)
  SELECT QYDM,QYMC,BYZD1 from  MS..QUYU
  ---供货商
  delete [E3_YHM_2022]..GHS
  INSERT INTO [E3_YHM_2022]..GHS(GHSDM,GHSMC,GHSLB,ZK,JG,TY,GHSXZ,BZ,CJR,CJRQ,DZ,YB,LXR,GDDH,SJBH,CZ,EMAIL,WZ,KHYH,ZHMC,ZH,FRDB)
  SELECT GHSDM,GHSMC,'000',ZK,'JJ',ty,'001','','SA',GETDATE(),DZ,YB,LXR,GDDH,SJ,CZ,EMAIL,WZ,KHYH,ZHMC,ZH,FRDB FROM  [MS]..GHS
  ---客户
  DELETE [E3_YHM_2022]..KEHU
  INSERT INTO [E3_YHM_2022]..KEHU(KHDM,KHMC,ZJF,KHXZ,CKDM,QDDM,LBDM,KL,YGDM,DZ,YB,LXR,GDDH,SJBH,CZ,EMAIL,WZ,KHYH,ZHMC,ZH,FRDB,BZ,QYDM,ZK,TY,JG,YDT,PPQX,XYJE,CJR,CJRQ)
  SELECT KHDM,KHMC,ZJF,KHXZ,CKDM,'000','000',0,'000',DZ,YB,LXR,GDDH,SJ,CZ,EMAIL,WZ,KHYH,ZHMC,ZH,FRDB,BZ,QYDM,ZK,TY,byzd2,ydt,0,XYJE,'SA',GETDATE() FROM [MS]..KEHU WHERE KHDM NOT IN(SELECT KHDM FROM [E3_YHM_2022]..KEHU)
  UPDATE [E3_YHM_2022]..KEHU SET KHXZ='000'  WHERE KHXZ='0'
  UPDATE [E3_YHM_2022]..KEHU SET KHXZ='000'  WHERE KHXZ='1'
  UPDATE [E3_YHM_2022]..KEHU SET KHXZ='001'  WHERE KHXZ='2'
  UPDATE [E3_YHM_2022]..KEHU SET KHXZ='002'  WHERE KHXZ='3'
  --添加单子里面需要的客户
      INSERT INTO [E3_YHM_2022]..KEHU(KHDM,KHMC,ZJF,KHXZ,CKDM,QDDM,LBDM,KL,YGDM,ZK,TY,JG,YDT,PPQX,CJR,CJRQ)
      VALUES('024','024','','000','','000','000',0,'000',1,0,'SJ1',0,0,'SA',GETDATE())
      INSERT INTO [E3_YHM_2022]..KEHU(KHDM,KHMC,ZJF,KHXZ,CKDM,QDDM,LBDM,KL,YGDM,ZK,TY,JG,YDT,PPQX,CJR,CJRQ)
      VALUES('074','074','','000','','000','000',0,'000',1,0,'SJ1',0,0,'SA',GETDATE())
      INSERT INTO [E3_YHM_2022]..KEHU(KHDM,KHMC,ZJF,KHXZ,CKDM,QDDM,LBDM,KL,YGDM,ZK,TY,JG,YDT,PPQX,CJR,CJRQ)
      VALUES('533','533','','000','','000','000',0,'000',1,0,'SJ1',0,0,'SA',GETDATE())
      INSERT INTO [E3_YHM_2022]..KEHU(KHDM,KHMC,ZJF,KHXZ,CKDM,QDDM,LBDM,KL,YGDM,ZK,TY,JG,YDT,PPQX,CJR,CJRQ)
      VALUES('648','648','','000','','000','000',0,'000',1,0,'SJ1',0,0,'SA',GETDATE())
      INSERT INTO [E3_YHM_2022]..KEHU(KHDM,KHMC,ZJF,KHXZ,CKDM,QDDM,LBDM,KL,YGDM,ZK,TY,JG,YDT,PPQX,CJR,CJRQ)
      VALUES('221','221','','000','','000','000',0,'000',1,0,'SJ1',0,0,'SA',GETDATE())
    INSERT INTO [E3_YHM_2022]..KEHU(KHDM,KHMC,ZJF,KHXZ,CKDM,QDDM,LBDM,KL,YGDM,ZK,TY,JG,YDT,PPQX,CJR,CJRQ)
      VALUES('086','086','','000','','000','000',0,'000',1,0,'SJ1',0,0,'SA',GETDATE())
  ---仓库
  DELETE [E3_YHM_2022]..CANGKU
  INSERT INTO [E3_YHM_2022]..CANGKU(CKDM,CKMC,ZJF,CKXZ,JGDM,ZK,TY,qydm,QDDM)
  select CKDM,CKMC,ZJF,CKXZ,'SJ',ZK,TY,'000','000' FROM [MS]..CANGKU WHERE CKDM NOT IN(SELECT CKDM FROM [E3_YHM_2022]..CANGKU )
  UPDATE [E3_YHM_2022]..CANGKU SET CKXZ='000'  WHERE CKXZ='1'
  UPDATE [E3_YHM_2022]..CANGKU SET CKXZ='001'  WHERE CKXZ='2'
  UPDATE [E3_YHM_2022]..CANGKU SET CKXZ='002'  WHERE CKXZ='3'
  ---店员
  DELETE [E3_YHM_2022]..DIANYUAN
  INSERT INTO [E3_YHM_2022]..DIANYUAN(DYDM,DYMC,DYXZ,GSSD,XGJG,DYZK,DYJE,TCBL,DXJE,CSRQ,RZRQ,LZRQ,DYDJ,TY,CJR,CJRQ)
  SELECT DYDM,DYMC,DYXZ,GSSD,0,1,0,0,0,CSRQ,RZRQ,RZRQ,0,ty,'sa',GETDATE() FROM [MS]..DIANYUAN  where DYDM not in(select DYDM from [E3_YHM_2022]..DIANYUAN )
/********************************进销存业务单据******************************************/
  DELETE [E3_YHM_2022]..CGRKDMX
  DELETE [E3_YHM_2022]..CGRKD
  DELETE [E3_YHM_2022]..CGCKDMX
  DELETE [E3_YHM_2022]..CGCKD
  ---入库
SELECT * FROM [E3_YHM_2022]..CGRKD
  INSERT INTO [E3_YHM_2022]..CGRKD(DJBH,RQ,CKDM,GHSDM,ZK,ZDR,ZDRQ,SL,JE,YSH,SHR,SHRQ,JG,BZ,YJZ,JZR,JZRQ)
  SELECT 'CG'+SUBSTRING(DJBH,3,18),RQ,CKDM,GHSDM,ZK,ZDR,ZDRQ,SL,HPZE,YSP,SPR,RQ,JG,BZ,YSP,SPR,RQ FROM [MS]..CGRKD
  INSERT INTO [E3_YHM_2022]..CGRKDMX(DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ)
  SELECT 'CG'+SUBSTRING(DJBH,3,18),MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ FROM [MS]..CGRKDMX WHERE DJBH  IN(SELECT DJBH FROM [E3_YHM_2022]..CGRKD)
  ---退货
  INSERT INTO [E3_YHM_2022]..CGCKD(DJBH,RQ,CKDM,GHSDM,ZK,ZDR,ZDRQ,SL,JE,YSH,SHR,SHRQ,JG,BZ,YSH,SHR,SHRQ)
  SELECT DJBH,RQ,CKDM,GHSDM,ZK,ZDR,ZDRQ,SL,HPZE,YSP,SPR,RQ,JG,BZ,YSP,SPR,RQ FROM [MS]..CGCKD
  INSERT INTO [E3_YHM_2022]..CGCKDMX(DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ)
  SELECT DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ FROM [MS]..CGCKDMX
      --修改价格标志
  update B  SET JG=A.JGDM FROM [E3_YHM_2022]..JIAGE  AS A,[E3_YHM_2022]..CGRKD as B WHERE A.JGMC=B.JG
  update B  SET JG=A.JGDM FROM [E3_YHM_2022]..JIAGE  AS A,[E3_YHM_2022]..CGCKD as B WHERE A.JGMC=B.JG
  ---调拨
  DELETE [E3_YHM_2022]..SPDBDmx
  DELETE [E3_YHM_2022]..SPDBD
  DELETE [E3_YHM_2022]..SPDBTmx
  DELETE [E3_YHM_2022]..SPDBT
  SELECT * FROM MS..SPDBt
  SELECT * FROM CANGKU
  INSERT INTO [E3_YHM_2022]..SPDBD(DJBH,RQ,KHDM,CKDM,ZK,ZDR,ZDRQ,SL,JE,YSH,SHR,SHRQ,YYS,YSR,YSRQ,JG,BZ,BYZD1)
  SELECT DJBH,RQ,KHDM,CKDM,ZK,ZDR,ZDRQ,SL,HPZE,YSP,SPR,RQ,YSH,SHR,RQ,JG,BZ,BYZD1 FROM [MS]..SPDBD WHERE KHDM IN(SELECT KHDM FROM [E3_YHM_2022]..KEHU)
  INSERT INTO [E3_YHM_2022]..SPDBDMX(DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ)
  SELECT DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ FROM [MS]..SPDBDMX  WHERE DJBH IN(SELECT DJBH FROM [E3_YHM_2022]..SPDBD)
  ---调拨退
  INSERT INTO [E3_YHM_2022]..SPDBT(DJBH,RQ,KHDM,CKDM,ZK,ZDR,ZDRQ,SL,JE,YSH,SHR,SHRQ,YYS,YSR,YSRQ,JG,BZ,byzd1)
  SELECT DJBH,RQ,KHDM,CKDM,ZK,ZDR,ZDRQ,SL,HPZE,YSP,SPR,RQ,YSH,SHR,RQ,JG,BZ,byzd1 FROM [MS]..SPDBT WHERE KHDM IN(SELECT KHDM FROM [E3_YHM_2022]..KEHU)
  INSERT INTO [E3_YHM_2022]..SPDBTMX(DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ)
  SELECT DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ FROM [MS]..SPDBTMX  WHERE DJBH IN(SELECT DJBH FROM [E3_YHM_2022]..SPDBT)
  --
  INSERT INTO [E3_YHM_2022]..SPDBT(DJBH,RQ,KHDM,CKDM,ZK,ZDR,ZDRQ,SL,JE,YSH,SHR,SHRQ,YYS,YSR,YSRQ,JG,BZ,byzd1)
  SELECT 'DT'+SUBSTRING(djbh,3,18),RQ,'037','000',ZK,ZDR,ZDRQ,SL,HPZE,YSP,SPR,RQ,1,SPR,RQ,JG,BZ,byzd1 FROM [MS]..ckycd WHERE djbh in('YC201510270933230000','YC201705081020090000')
  INSERT INTO [E3_YHM_2022]..SPDBTMX(DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ)
  SELECT 'DT'+SUBSTRING(djbh,3,18),MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ FROM [MS]..CKYCDMX  WHERE djbh in('YC201510270933230000','YC201705081020090000')
      --修改价格标志
  update B  SET JG=A.JGDM FROM [E3_YHM_2022]..JIAGE  AS A,[E3_YHM_2022]..SPDBD as B WHERE A.JGMC=B.JG
  update B  SET JG=A.JGDM FROM [E3_YHM_2022]..JIAGE  AS A,[E3_YHM_2022]..SPDBT as B WHERE A.JGMC=B.JG
  ---零售单
  SELECT * FROM ms..LSXHD where VIPDM!=''
  DELETE [E3_YHM_2022]..QTLSDMX
  DELETE [E3_YHM_2022]..QTLSD
  INSERT INTO [E3_YHM_2022]..QTLSD(DJBH,RQ,CKDM,KHDM,VIPDM,ZK,ZDR,ZDRQ,SL,JE,YSH,SHR,SHRQ,JG,BZ,DYDM,JFS)
  SELECT DJBH,RQ,KHDM,CKDM,VIPDM,A.ZK,ZDR,ZDRQ,SL,HPZE,YSP,SPR,RQ,'SJ',A.BZ,DYDM,JFS FROM [MS]..LSXHD A
  INSERT INTO [E3_YHM_2022]..QTLSDMX(DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ)
  SELECT DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ FROM [MS]..LSXHDMX  WHERE  DJBH IN(SELECT DJBH FROM [E3_YHM_2022]..QTLSD)
  ---付款单
  DELETE FROM POSJSFS
  INSERT INTO POSJSFS(JSDM,JSMC,ZL,CJR,CJRQ,TY,JFBL)
  SELECT jsdm,jsmc,zl,cjr,cjrq,TY,bl from MS..LSJSFS
  --修改ms零售付款单代码
    update MS..LSFKD set JSDM =a.JSDM from MS..LSJSFS as a  where a.JSMC=MS..LSFKD.JSFS
    --根据E3前台零售单添加结算单
  DELETE [E3_YHM_2022]..QTJSD
  --INSERT INTO [E3_YHM_2022]..QTJSD(DJBH,MXBH,JSDM,JSJE,ZLJE)
  --SELECT DJBH,1,'000',JE,0 FROM [E3_YHM_2022]..QTLSD WHERE YSH=1
  --根据MS付款单添加结算单
  INSERT INTO [E3_YHM_2022]..QTJSD (DJBH,MXBH,JSDM,JSJE,ZLJE,bz,BYZD1)
  SELECT djbh,ROW_NUMBER() OVER (ORDER BY NEWID()) AS mxbh,jsdm,je,zlje,bz,JSFS from MS..LSFKD AS A
  ---仓库调整单
  DELETE [E3_YHM_2022]..CKTZDMX
  DELETE [E3_YHM_2022]..CKTZD
  INSERT INTO [E3_YHM_2022]..CKTZD(DJBH,RQ,CKDM,ZK,ZDR,ZDRQ,SL,JE,YSH,SHR,SHRQ,JG,BZ)
  SELECT DJBH,RQ,CKDM,ZK,ZDR,ZDRQ,SL,HPZE,YSP,SPR,RQ,'SJ',BZ FROM [MS]..CKTZD
  INSERT INTO [E3_YHM_2022]..CKTZDMX(DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ)
  SELECT DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ FROM [MS]..CKTZDMX  WHERE DJBH IN(SELECT DJBH FROM [E3_YHM_2022]..CKTZD)
  --仓库盘点单
  delete FROM [E3_YHM_2022]..CKPDDMX
  DELETE FROM [E3_YHM_2022]..CKPDD
    INSERT INTO [E3_YHM_2022]..CKPDD(DJBH,RQ,CKDM,ZK,ZDR,ZDRQ,SL,JE,YSH,SHR,SHRQ,YYS,YSR,YSRQ,JG,BZ)
  SELECT DJBH,RQ,CKDM,ZK,ZDR,ZDRQ,SL,HPZE,YSP,SPR,RQ,YSK,SKR,SKRQ,'SJ',BZ FROM [MS]..CKPDD
    INSERT INTO [E3_YHM_2022]..CKPDDMX(DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ)
  SELECT DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ FROM [MS]..CKPDDMX  WHERE DJBH IN(SELECT DJBH FROM [E3_YHM_2022]..CKPDD)AND HPDM IN(SELECT HPDM FROM HPXX)

  --仓库盈亏单
    INSERT INTO [E3_YHM_2022]..CKYKD(DJBH,RQ,CKDM,ZK,ZDR,ZDRQ,SL,JE,YSH,SHR,SHRQ,YYS,YSR,YSRQ,JG,BZ)
  SELECT DJBH,RQ,CKDM,ZK,ZDR,ZDRQ,SL,HPZE,YSP,SPR,RQ,YSK,SKR,SKRQ,'SJ',BZ FROM [MS]..CKYKD
    INSERT INTO [E3_YHM_2022]..CKYKDMX(DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ)
  SELECT DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ FROM [MS]..CKYKDMX  WHERE DJBH IN(SELECT DJBH FROM [E3_YHM_2022]..CKYKD)AND HPDM IN(SELECT HPDM FROM HPXX)
  ---仓库移仓单
  DELETE [E3_YHM_2022]..CKYCDMX
  DELETE [E3_YHM_2022]..CKYCD
  --仓库-仓库
  INSERT INTO [E3_YHM_2022]..CKYCD(DJBH,RQ,YRDM,YCDM,ZK,ZDR,ZDRQ,SL,JE,YSH,SHR,SHRQ,YYS,YSR,YSRQ,JG,BZ,YCXZ)
  SELECT DJBH,RQ,YRCK,YCCK,ZK,ZDR,ZDRQ,SL,HPZE,YSP,SPR,RQ,YSK,SKR,RQ,'SJ',BZ,'仓库-仓库' FROM [MS]..CKYCD where YRCK in(select ckdm from CANGKU where CKXZ='000') and YCCK in(select ckdm from CANGKU where CKXZ='000')
  --店铺-店铺
  INSERT INTO [E3_YHM_2022]..CKYCD(DJBH,RQ,YRDM,YCDM,ZK,ZDR,ZDRQ,SL,JE,YSH,SHR,SHRQ,YYS,YSR,YSRQ,JG,BZ,YCXZ)
  SELECT DJBH,RQ,YRCK,YCCK,ZK,ZDR,ZDRQ,SL,HPZE,YSP,SPR,RQ,YSK,SKR,RQ,'SJ',BZ,'店铺-店铺' FROM [MS]..CKYCD where YRCK in(select ckdm from CANGKU where CKXZ!='000') and YCCK in(select ckdm from CANGKU where CKXZ!='000')
  INSERT INTO [E3_YHM_2022]..CKYCDMX(DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ)
  SELECT DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ FROM [MS]..CKYCDMX  WHERE  djbh not in('YC201510270933230000','YC201705081020090000')
    --修改价格标志
  update B  SET JG=A.JGDM FROM [E3_YHM_2022]..JIAGE  AS A,[E3_YHM_2022]..CKPDD as B WHERE A.JGMC=B.JG
  update B  SET JG=A.JGDM FROM [E3_YHM_2022]..JIAGE  AS A,[E3_YHM_2022]..CKYKD as B WHERE A.JGMC=B.JG
  update B  SET JG=A.JGDM FROM [E3_YHM_2022]..JIAGE  AS A,[E3_YHM_2022]..CKTZD as B WHERE A.JGMC=B.JG
  update B  SET JG=A.JGDM FROM [E3_YHM_2022]..JIAGE  AS A,[E3_YHM_2022]..CKYCD as B WHERE A.JGMC=B.JG

  ---批发销货单
  DELETE [E3_YHM_2022]..PFXHDMX
  DELETE [E3_YHM_2022]..PFXHD
  INSERT INTO [E3_YHM_2022]..PFXHD(DJBH,RQ,CKDM,KHDM,GLDDBH,ZK,SL,JE,ZDR,ZDRQ,YSH,SHR,SHRQ,YYS,YSR,YSRQ,YJZ,JZR,JZRQ,JG,BZ,BYZD1,JSJE,JSR,JSRQ,YJS)
  SELECT DJBH,RQ,CKDM,KHDM,GLDDBH,ZK,SL,HPZE,ZDR,ZDRQ,YSP,SPR,SPRQ,YSP,SPR,SPRQ,YSP,SPR,SPRQ,JG,BZ,BYZD1,SKZE,SKR,SKRQ,YSK FROM [MS]..PFXHD
  INSERT INTO [E3_YHM_2022]..PFXHDMX(DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ)
  SELECT DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ FROM [MS]..PFXHDMX  WHERE DJBH IN(SELECT DJBH FROM [E3_YHM_2022]..PFXHD)
  --批发退货单
  DELETE [E3_YHM_2022]..PFTHDMX
  DELETE [E3_YHM_2022]..PFTHD
  INSERT INTO [E3_YHM_2022]..PFTHD(DJBH,RQ,CKDM,KHDM,GLDDBH,ZK,SL,JE,ZDR,ZDRQ,YSH,SHR,SHRQ,YYS,YSR,YSRQ,YJZ,JZR,JZRQ,JG,BZ,BYZD1)
  SELECT DJBH,RQ,CKDM,KHDM,GLDDBH,ZK,SL,HPZE,ZDR,ZDRQ,YSP,SPR,SPRQ,YSP,SPR,SPRQ,YSP,SPR,SPRQ,JG,BZ,BYZD1 FROM [MS]..PFTHD
  INSERT INTO [E3_YHM_2022]..PFTHDMX(DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ)
  SELECT DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE,BZ FROM [MS]..PFTHDMX  WHERE DJBH IN(SELECT DJBH FROM [E3_YHM_2022]..PFTHD)
  --修改价格标志
  update B  SET JG=A.JGDM FROM [E3_YHM_2022]..JIAGE  AS A,[E3_YHM_2022]..PFXHD as B WHERE A.JGMC=B.JG
  update B  SET JG=A.JGDM FROM [E3_YHM_2022]..JIAGE  AS A,[E3_YHM_2022]..PFTHD as B WHERE A.JGMC=B.JG
/********************************客户往来业务单据******************************************/
  --应收款调整单
  SELECT *  FROM MS..YSKTZD
  DELETE [E3_YHM_2022]..YSKTZD
  INSERT INTO [E3_YHM_2022]..YSKTZD(DJBH,QDDM,KHDM,RQ,YDBH,TZLX,JE,ZDR,ZDRQ,YJZ,JZRQ,JZR,BYZD1)
  SELECT DJBH,'000',KHDM,RQ,YDBH,TZLX,JE,ZDR,ZDRQ,JSP,JSRQ,JSR,BZ FROM [MS]..YSKTZD
  DELETE [E3_YHM_2022]..YFKTZD
  INSERT INTO [E3_YHM_2022]..YFKTZD(DJBH,QDDM,GHSDM,RQ,YDBH,TZLX,JE,ZDR,ZDRQ,YJZ,JZRQ,JZR,BYZD1)
  SELECT DJBH,'000',GHSDM,RQ,YDBH,TZLX,JE,ZDR,ZDRQ,JSP,JSRQ,JSR,BZ FROM [MS]..YFKTZD
  --收款单
  DELETE [E3_YHM_2022]..KHSKD
  INSERT INTO [E3_YHM_2022]..KHSKD(DJBH,QDDM,KHDM,RQ,YDBH,SKLX,SCQK,JE,ZDR,ZDRQ,JZR,JZRQ,YJZ,BZ)
  SELECT DJBH,'000',KHDM,RQ,YDBH,TZLX,SCQK,JE,ZDR,ZDRQ,JSR,JSRQ,jsp,BZ FROM [MS]..KHSKD
  INSERT  INTO [E3_YHM_2022]..KHSKDMX1(DJBH,MXBH,YHDM,JE)
  select  DJBH,MXBH,JSFS,JE from ms..KHSKD
  --付款单
  DELETE [E3_YHM_2022]..GHSFKD
  INSERT INTO [E3_YHM_2022]..GHSFKD(DJBH,QDDM,GHSDM,RQ,YDBH,FKLX,SCYF,JE,ZDR,ZDRQ,JZR,JZRQ,YJZ,BZ)
  SELECT DJBH,'000',GHSDM,RQ,YDBH,TZLX,SCQK,JE,ZDR,ZDRQ,JSR,JSRQ,jsp,BZ FROM [MS]..GHSFKD
    INSERT  INTO [E3_YHM_2022]..GHSFKDMX1(DJBH,MXBH,YHDM,JE)
  select  DJBH,MXBH,JSFS,JE from ms..GHSFKD
  ----------------------------*****费用单*****--------------------------------------------
  --现金银行科目
  delete from XJYH
  DELETE FROM YHKM
  insert into [E3_YHM_2022]..XJYH(XJYHDM,XJYHMC,xz,JE,KHYH,YHZH,KHMC,BYZD1,BYZD2)
  select lxdm,lxmc,1,JE,KHYH,YHZH,KHXM,byzd1,BYZD2 from ms..jslx
  insert into [E3_YHM_2022]..YHKM(YHDM,YHMC,YHXZ,YHHM,KHYH,YHZH,JE)
  select lxdm,lxmc,1,'',KHYH,YHZH,JE from ms..jslx
  --删除费用相关单据
  DELETE FROM [E3_YHM_2022]..XSFYDMX
  DELETE FROM [E3_YHM_2022]..XSFYDMX1
  DELETE FROM [E3_YHM_2022]..XSFYD
  DELETE FROM FEIYONG
  --添加费用
  INSERT INTO [E3_YHM_2022]..FEIYONG(FYDM,FYMC,CJR,CJRQ,TY)
  SELECT FYDM,FYMC,'SA',GETDATE(),0 FROM MS..FEIYONG
  --费用单
  INSERT INTO [E3_YHM_2022]..XSFYD(DJBH,RQ,DJLX,KHDM,FYJE,YDBH,ZDR,ZDRQ,YSH,SHRQ,SHR,JZR,JZRQ,YJZ,BZ)
  SELECT DJBH,RQ,TZLX,KHDM,JE,YDBH,ZDR,ZDRQ,1,JSRQ,JSR,JSR,JSRQ,1,BZ  FROM MS..XHFYD
  --费用单费用明细
  INSERT INTO [E3_YHM_2022]..XSFYDMX(DJBH,MXBH,FYDM,FYJE)
  SELECT  DJBH,MXBH,FYDM,JE FROM MS..XHFYD
  --费用单收款方式明细
  UPDATE MS..XHFYD SET JSFS='000' WHERE DJBH='FY0000003069'
  INSERT INTO [E3_YHM_2022]..XSFYDMX1(DJBH,MXBH,YHDM,JE)
  SELECT  DJBH,MXBH,JSFS,JE FROM MS..XHFYD

/********************************会员资料单据******************************************/

  --1、导入VIP类别
INSERT INTO VIPLB(LBDM,LBMC,ZK,JFBL,LJJF,S_JF,E_JF,SRJFBL)
SELECT XZDM,XZMC,ZK,JF,0,0,0,0 FROM MS..VIPXZ

--2、导入VIP信息
INSERT INTO VIPSET (VIPDM,VIPMC,CSRQ,SJBH,GLSD,CJR,CJRQ,LJJF,DQJF,LJXFJE,DQJE,LBDM,QY,QYRQ,QYR,TY,TYRQ,TYR,PWD,VIPPWD,SEX)
SELECT VIPDM,VIPMC,CSRQ,SJ,GLSD,CJR,CJRQ,JF,JF,LJXFJE,CZJE,
(case VIPXZ when 'VIP' then '002' when '普通' then '001' else '001' end),0,QYRQ,QYR,TY,tyrq,tyr,PWD,vippwd,
(case vipsex when '女' then 1 when '男' THEN 2 ELSE 1 END) from MS..VIPSET
--3、修改积分调整的ydbh
update  MS..JFTZD set YDBH=0 where YDBH=''
--4、导入积分调整单
INSERT INTO VIPJFTZD(DJBH,RQ,KHDM,VIPDM,YDBH,TZLX,YJF,TZJF,ZDR,ZDRQ,YSH,SHR,SHRQ,BZ)
SELECT DJBH,RQ,KHDM,VIPDM,'',TZLX,cast(YDBH  as decimal(18,2)),JF,ZDR,ZDRQ,JSP,JSR,JSRQ,BZ FROM MS..JFTZD WHERE VIPDM IN(SELECT VIPDM FROM VIPSET  )
--5、根据积分记录表获取
SELECT VIPDM ,SUM(JFS) AS JF INTO #JF1 FROM VW_VIPJFJLB GROUP BY VIPDM
SELECT A.VIPDM,A.DQJF ,B.JF FROM VIPSET AS A ,#JF1 AS B WHERE A.VIPDM=B.VIPDM AND A.DQJF!=B.JF
--允许将显式值插入表的标识列中 ON-允许
set identity_insert jftzd ON
--导入积分调整单
INSERT INTO VIPJFTZD(DJBH,VIPDM,RQ,YDBH,TZLX,YJF,TZJF,ZDR,ZDRQ,YSH,SHR,SHRQ,KHDM,BZ)
SELECT 'JF'+right(cast('10000000000' as varchar)+ROW_NUMBER() OVER (ORDER BY NEWID()),10) AS DJBH,
a.VIPDM,'2020-07-01','','期初调整',0,a.DQJF,'SA',GETDATE(),1,'SA',GETDATE(),A.GLSD,A.BZ from VIPSET as a
WHERE A.DQJF!=0
INSERT INTO VIPJFTZD(DJBH,VIPDM,RQ,YDBH,TZLX,YJF,TZJF,ZDR,ZDRQ,YSH,SHR,SHRQ,KHDM,BZ)
SELECT 'JF'+right(cast('10000000650' as varchar)+ROW_NUMBER() OVER (ORDER BY NEWID()),10) AS DJBH,
a.VIPDM,'2020-07-01','','期初调整',B.JF,a.DQJF-B.JF,'SA',GETDATE(),1,'SA',GETDATE(),A.GLSD,A.BZ from VIPSET AS A ,#JF1 AS B WHERE A.VIPDM=B.VIPDM AND A.DQJF!=B.JF
--允许将显式值插入表的标识列中 OFF-关闭
set identity_insert jftzd OFF
--允许将显式值插入表的标识列中 ON-允许
set identity_insert VIPCZD ON
--导入会员储值单
INSERT INTO VIPCZD(DJBH,MXBH,VIPDM,RQ,YDBH,TZLX,CZJE,ZDR,ZDRQ,JSRQ,JSR,JSP,KHDM,BZ,zsje,sjje,ZSJF,DYDM)
SELECT 'CZ'+right(cast('10000000000' as varchar)+ROW_NUMBER() OVER (ORDER BY NEWID()),10) AS DJBH,ROW_NUMBER() OVER (ORDER BY NEWID()) as mxbh,
a.VIPDM,'2020-07-01',0,'一般充值',a.CZJE,'SA',GETDATE(),getdate(),'SA',1,A.GLSD,A.BZ,0,A.CZJE,0, '001' from VIPSET as a
WHERE A.CZJE >=0 OR A.CZJE<='0'
--允许将显式值插入表的标识列中 OFF-关闭
set identity_insert VIPCZD OFF
--导入会员储值单明细
INSERT INTO VIPCZDMX (DJBH ,MXBH,JSDM,JE)
SELECT DJBH,MXBH,'000',CZJE FROM VIPCZD

/***************************************系统管理******************************************/

--添加用户
INSERT INTO SYSTEM_USERS(USERID,USERNAME,PWD,TY,QX_PP,QX_GHS,QX_CK,QX_QY,QX_KH,QX_QD,QX_DL)
select YHDM,YHMC,YHMM,0,1,1,1,1,1,1,1 from ms..YONGHU WHERE YHDM NOT IN(SELECT USERID FROM SYSTEM_USERS)
--添加角色
DELETE FROM SYS_RULE
INSERT INTO SYS_RULE(RLID,RLNAME)
select YHDM,YHMC from ms..YONGHU
--角色权限，进系统设置；
--条码
delete FROM [E3_YHM_2022]..TMFA
INSERT INTO  [E3_YHM_2022]..TMFA
SELECT *FROM MS..TMFA
```

```
insert into hpys (hpdm,ysdm)
select hpdm,'01' from hpxx where hpdm+'01' not in(select hpdm+ysdm from hpys)
```

## 3. 添加店铺所需权限

```
--添加客户权限
insert into KHQXSET
select KHDM,0,1,0,1,0,0,1,1,0,0,'90','90',1,0,0,1,0,0,'10','',0,0,0,0,0,1 FROM KEHU WHERE KHXZ IN('001','002') AND KHDM NOT IN(select KHDM from KHQXSET)
--添加店铺与店铺的调拨权限
INSERT INTO KHQX_DB(KHDM,CKDM)
SELECT KHDM,B.CKDM FROM KEHU  AS A ,CANGKU  AS B WHERE CKXZ!='000'
--添加店铺查询其他店铺库存权限
INSERT INTO KHQX_KC(KHDM,CKDM)
SELECT KHDM,B.CKDM FROM KEHU  AS A ,CANGKU  AS B WHERE CKXZ!='000'
```

## 4. 更新上次欠款

```
declare @i int
declare @max int
declare @khdm varchar(20)

 if object_id('tempdb..#temp_KEHU') is not null Begin drop table #temp_KEHU End
 select  ROW_NUMBER() OVER(ORDER BY khdm ASC) as row,khdm INTO  #temp_KEHU from kehu  where khxz in('001','000')

select  @max=COUNT(*) from #temp_KEHU
set @i=1

while @i<=@max
begin
/***获取客户代码****/
select @khdm=khdm from #temp_KEHU
where row=@i

 if object_id('tempdb..#temp_khdzd') is not null Begin drop table #temp_khdzd End

/***插入客户对账信息***/
select ROW_NUMBER() OVER(ORDER BY khdm,RQ asc,DJMC) mxbh, DJMC, rq,KHDM,DJBH,JE-SKJE+TZJE+FYJE as je,0.00 as qmje INTO #temp_khdzd from VW_KHDZD
where YJZ=1  AND KHDM=''+@khdm+''
order by KHDM,RQ asc,DJMC

ALTER TABLE #temp_khdzd ALTER COLUMN qmje numeric(38,4)

/***更新对账单余额***/
declare @index int
declare @imax int
set @index=1
set @imax=0
select @imax=COUNT(*) from  #temp_khdzd

while @index<=@imax
begin
if(@index=1) begin update #temp_khdzd set qmje=je where mxbh=@index end
else
begin  update #temp_khdzd set qmje=je+(select  top 1 qmje from #temp_khdzd where mxbh=@index-1) where mxbh=@index end
set @index=@index+1
end

/***更新到业务单据上***/
 if((select top 1 djmc from #temp_khdzd where mxbh=@i)='批发销货单')
 begin
   update a set a.scqk=b.qmje-b.je from PFXHD a,#temp_khdzd b where a.DJBH=b.DJBH and b.mxbh=@i
 end
  if((select top 1 djmc from #temp_khdzd where mxbh=@i)='批发退货单')
 begin
   update a set a.scqk=b.qmje-b.je from PFTHD a,#temp_khdzd b where a.DJBH=b.DJBH and b.mxbh=@i
 end
   if((select top 1 djmc from #temp_khdzd where mxbh=@i)='收款单')
 begin
   update a set a.scqk=b.qmje-b.je from KHSKD a,#temp_khdzd b where a.DJBH=b.DJBH and b.mxbh=@i
 end
set @i=@i+1
end

/****删除临时表***/
if object_id('tempdb..#temp_KEHU') is not null Begin drop table #temp_KEHU End
 if object_id('tempdb..#temp_khdzd') is not null Begin drop table #temp_khdzd End
```

## 5. 删除系统所有表数据

```
--删除采购管理
DELETE FROM CGRKDMX
DELETE FROM CGRKD
DELETE FROM CGCKDMX
DELETE FROM CGCKD
DELETE FROM CSENDMX
DELETE FROM CSEND
DELETE FROM CREQUESTMX
DELETE FROM CREQUEST
DELETE FROM CTSENDMX
DELETE FROM CTSEND
DELETE FROM CORDERMX
DELETE FROM CORDER
--删除调拨管理
DELETE FROM SPDBDMX
DELETE FROM SPDBD
DELETE FROM SPDBTMX
DELETE FROM SPDBT
DELETE FROM SSENDMX
DELETE FROM SSEND
DELETE FROM STSENDMX
DELETE FROM STSEND
DELETE FROM SREQUESTMX
DELETE FROM SREQUEST
DELETE FROM SORDERMX
DELETE FROM SORDER

--删除销售管理
DELETE FROM PFXHDMX
DELETE FROM PFXHD
DELETE FROM PFTHDMX
DELETE FROM PFTHD
DELETE FROM PSENDMX
DELETE FROM PSEND
DELETE FROM PTSENDMX
DELETE FROM PTSEND
DELETE FROM PREQUESTMX
DELETE FROM PREQUEST
DELETE FROM PORDERMX
DELETE FROM PORDER

--删除零售管理
DELETE FROM QTJSD
DELETE FROM QTLSDMX
DELETE FROM QTLSDLS
DELETE FROM QTLSD

--删除库存管理
DELETE FROM CKYKDMX
DELETE FROM CKYKD
DELETE FROM CKTZDMX
DELETE FROM CKTZD
DELETE FROM CKYCDMX
DELETE FROM CKYCD
DELETE FROM CKPDDMX
DELETE FROM CKPDD
delete FROM SDBHDMX
DELETE FROM SDBHD
DELETE FROM SPTJDMX
DELETE FROM SPTJDMX1
DELETE FROM SPTJD

--删除财务管理
DELETE FROM GHSFKDMX1
DELETE FROM GHSFKDMX
DELETE FROM GHSFKD
DELETE FROM KHFYDMX
DELETE FROM KHFYD
DELETE FROM KHCKTZD
DELETE FROM KHCKD
DELETE FROM KHSKDMX1
DELETE FROM KHSKDMX
DELETE FROM KHSKD
delete from XSFYDMX
delete from XSFYDMX1
delete from XSFYD
DELETE FROM FEIYONG
DELETE FROM GHSYFB
DELETE FROM KHYSB

--删除会员管理
DELETE FROM VIPCZDMX
DELETE FROM VIPCZD
DELETE FROM VIPCZTZD
DELETE FROM VIPCZZSTZD
DELETE FROM VIPFQJFTZD
DELETE FROM VIPJFTZD
DELETE FROM VIPLJJFTZD
DELETE FROM VIPQPSDMX
DELETE FROM VIPQPSD
DELETE FROM VIPQSENDMX
DELETE FROM VIPQSEND
DELETE FROM VIPQSET_LBXX
DELETE FROM VIPQSET_SEND_SALE_MX
DELETE FROM VIPQSET_SEND_SALE
DELETE FROM VIPQSET_VIPJLB
DELETE FROM VIPQSET_VIPXX
DELETE FROM VIPQSET
DELETE FROM VIPQ_DHJLB
DELETE FROM VIPQ_DHSET
DELETE FROM VIPXFSET
DELETE FROM VIPXFSETJL
DELETE FROM VIPXFSET_COUPON
DELETE FROM VIPXFSET_KEHU
DELETE FROM VIP_PLUS_CZD
DELETE FROM VIPCZDSET_KEHU
DELETE FROM VIPCZDSET_COUPON
DELETE FROM VIPCZDSET
DELETE FROM VIPLPLQDMX
DELETE FROM VIPLPLQD
DELETE FROM COUPON_PAY_VIP
DELETE FROM COUPON_PAY_KEHU
DELETE FROM COUPON_PAY_COUPON
DELETE FROM COUPON_PAYSET
DELETE FROM CouponModels
delete from VIPTICKET
delete from vipset


--维护库存
EXEC P_CreateKcwf ''

--删除商品信息
DELETE FROM HPYS
DELETE FROM HPCM
DELETE FROM YANSE
DELETE FROM CHIMAZUMX
DELETE FROM CHIMAZU
DELETE FROM CHIMA
DELETE FROM DALEI
DELETE FROM PINPAI
DELETE FROM JIJIE
DELETE FROM NIANFEN
DELETE FROM SPSX1
DELETE FROM SPSX2
DELETE FROM SPSX3
DELETE FROM SPSX4
DELETE FROM SPSX5
DELETE FROM SPSX6
DELETE FROM SPSX7
DELETE FROM SPSX8
DELETE FROM SPSX9
DELETE FROM SPSX10
DELETE FROM HPXX

--删除销售档案

DELETE FROM GHS
DELETE FROM KEHU
DELETE FROM CANGKU
DELETE FROM DIANYUAN E3降级MS脚本
SELECT * FROM CBJLB



DELETE FROM CZJLB
DELETE FROM VIPTICKET
DELETE FROM CGRKDMX
DELETE FROM CGRKD
DELETE FROM CSENDMX
DELETE FROM CSEND
DELETE FROM CORDERMX
DELETE FROM CORDER
DELETE FROM CGCKDMX
DELETE FROM CGCKD
DELETE FROM CTSENDMX
DELETE FROM CTSEND
DELETE FROM CREQUESTMX
DELETE FROM CREQUEST
DELETE FROM SPDBDMX
DELETE FROM SPDBD
DELETE FROM SSENDMX
DELETE FROM SSEND
DELETE FROM SORDERMX
DELETE FROM SORDER
DELETE FROM SPDBTMX
DELETE FROM SPDBT
DELETE FROM STSENDMX
DELETE FROM STSEND
DELETE FROM SREQUESTMX
DELETE FROM SREQUEST
DELETE FROM PFXHDMX
DELETE FROM PFXHD
DELETE FROM PFTHDMX
DELETE FROM PFTHD
DELETE FROM PSENDMX
DELETE FROM PSEND
DELETE FROM PORDERMX
DELETE FROM PORDER
DELETE FROM PTSENDMX
DELETE FROM PTSEND
DELETE FROM PREQUESTMX
DELETE FROM PREQUEST
DELETE FROM QTLSDMX
DELETE FROM QTJSD
DELETE FROM QTLSD
DELETE FROM CKPDDMX
DELETE FROM CKPDD
DELETE FROM CKYKDMX
DELETE FROM CKYKD
DELETE FROM CKTZDMX
DELETE FROM CKTZD
DELETE FROM CKYCDMX
DELETE FROM CKYCD
DELETE FROM GHSFKDMX1
DELETE FROM GHSFKDMX
DELETE FROM GHSFKD
DELETE FROM YFKTZD
DELETE FROM YSKTZD
DELETE FROM KHSKDMX1
DELETE FROM KHSKDMX
DELETE FROM KHSKD
DELETE FROM XSFYDMX1
DELETE FROM XSFYDMX
DELETE FROM XSFYD
DELETE FROM VIPTICKET
DELETE FROM VIPQPSDMX
DELETE FROM VIPQPSD
DELETE FROM VIPQSENDMX
DELETE FROM VIPQSEND
DELETE FROM VIPQSET_VIPXX
DELETE FROM VIPQSET_VIPJLB
DELETE FROM VIPQSET_SEND_SALE_MX
DELETE FROM VIPQSET_SEND_SALE
DELETE FROM VIPQSET_LBXX
DELETE FROM VIPQSET
DELETE FROM VIPQ_DHJLB
DELETE FROM VIPQ_DHSET_KEHU
DELETE FROM VIPQ_DHSET
DELETE FROM VIPXFSET_COUPON
DELETE FROM VIPXFSETJL
DELETE FROM VIPXFSET_KEHU
DELETE FROM VIPXFSET
```

## 6. E3 账套转接

```
--CG
DELETE  [E3_001_2019]..CGRKDMX
DELETE  [E3_001_2019]..CGRKD
DELETE  [E3_001_2019]..CGCKDMX
DELETE  [E3_001_2019]..CGCKD
DELETE  [E3_001_2019]..CORDERMX
DELETE  [E3_001_2019]..CORDER
--PF
DELETE  [E3_001_2019]..PFXHDMX
DELETE  [E3_001_2019]..PFXHD
DELETE  [E3_001_2019]..PFTHDMX
DELETE  [E3_001_2019]..PFTHD
DELETE  [E3_001_2019]..PSENDMX
DELETE  [E3_001_2019]..PORDERMX
DELETE  [E3_001_2019]..PORDER
--DB
DELETE  [E3_001_2019]..SPDBDMX
DELETE  [E3_001_2019]..SPDBD
DELETE  [E3_001_2019]..SPDBTMX
DELETE  [E3_001_2019]..SPDBT
--CK
DELETE  [E3_001_2019]..CKPDDMX
DELETE  [E3_001_2019]..CKPDD
DELETE  [E3_001_2019]..CKYKDMX
DELETE  [E3_001_2019]..CKYKD
DELETE  [E3_001_2019]..CKTZDMX
DELETE  [E3_001_2019]..CKTZD
DELETE  [E3_001_2019]..HPKCB
DELETE [E3_001_2019]..CKYCDMX
DELETE [E3_001_2019]..CKYCD
--LS
DELETE  [E3_001_2019]..QTLSDMX
DELETE  [E3_001_2019]..QTLSD
DELETE  [E3_001_2019]..QTJSD
DELETE [E3_001_2019]..SDBHDMX
DELETE [E3_001_2019]..SDBHD
--SP
DELETE [E3_001_2019]..TMDZB
DELETE [E3_001_2019]..SPTJDMX
DELETE [E3_001_2019]..SPTJDMX1
DELETE [E3_001_2019]..SPTJD
DELETE [E3_001_2019]..HPYS
DELETE [E3_001_2019]..HPCM
DELETE [E3_001_2019]..HPXX
DELETE [E3_001_2019]..CHIMAZUMX
DELETE [E3_001_2019]..CHIMAZU
--XS
DELETE [E3_001_2019]..VIPJFTZD
DELETE [E3_001_2019]..KHCKTZD
DELETE [E3_001_2019]..XSFYDMX
DELETE [E3_001_2019]..XSFYDMX1
DELETE [E3_001_2019]..XSFYD
DELETE [E3_001_2019]..KHCKD
DELETE [E3_001_2019]..KEHU
DELETE [E3_001_2019]..CANGKU
--GHS
DELETE [E3_001_2019]..GHSYFB
DELETE [E3_001_2019]..GHSFKDMX1
DELETE [E3_001_2019]..GHSFKDMX
DELETE [E3_001_2019]..GHSFKD
DELETE [E3_001_2019]..YFKTZD
DELETE [E3_001_2019]..GHS


 /********************************商品资料******************************************/
---导入颜色
  delete [E3_001_2019]..YANSE
  INSERT INTO [E3_001_2019]..YANSE(YSDM,YSMC)
  SELECT ysdm,ysmc from [E3_001_2018]..yanse  where ysdm not in(select ysdm from [E3_001_2019]..yanse)
--尺码
  delete  [E3_001_2019]..chima
  INSERT INTO [E3_001_2019]..CHIMA(CMDM,CMMC,CWZ,LWZ,CMDZ)
  SELECT CMDM,CMMC,CWZ,LWZ,CMDZ from [E3_001_2018]..CHIMA  where CMDM not in(select CMDM from [E3_001_2019]..CHIMA)

  delete  [E3_001_2019]..chimazu
  INSERT INTO [E3_001_2019]..CHIMAZU(CMZDM,CMZMC,TY)
  SELECT CMZDM,CMZMC,TY from [E3_001_2018]..CHIMAzu

  delete  [E3_001_2019]..chimazuMX
  INSERT INTO [E3_001_2019]..CHIMAZUMX(CMZDM,CMDM)
  SELECT  CMZDM,CMDM from [E3_001_2018]..CHIMAzumx

  --品牌
  delete [E3_001_2019]..PINPAI
  insert into [E3_001_2019]..PINPAI(PPDM,PPMC)
  select ppdm,ppmc from [E3_001_2018]..PINPAI where PPDM not in(select PPDM from [E3_001_2019]..PINPAI)
  --大类
  delete [E3_001_2019]..DALEI
  insert into [E3_001_2019]..DALEI(DLDM,DLMC)
  select DLDM,DLMC from [E3_001_2018]..DALEI where DLDM  not in(SELECT dldm from [E3_001_2019]..DALEI)
  --年份
  DELETE [E3_001_2019]..NIANFEN
  INSERT INTO [E3_001_2019]..NIANFEN(NFDM,NFMC)
  SELECT NFDM,NFMC FROM  [E3_001_2018]..NIANFEN WHERE NFDM NOT IN(SELECT NFDM FROM [E3_001_2019]..NIANFEN)
  --季节
  DELETE [E3_001_2019]..JIJIE
  INSERT INTO [E3_001_2019]..JIJIE(JJDM,JJMC)
  SELECT JJDM,JJMC FROM [E3_001_2018]..JIJIE WHERE JJDM NOT IN(SELECT JJDM FROM [E3_001_2019]..JIJIE)
  --款式
   DELETE [E3_001_2019]..SPSX1
   INSERT INTO [E3_001_2019]..SPSX1(SXDM,SXMC)
   SELECT SXDM,SXMC FROM [E3_001_2018]..SPSX1 WHERE SXDM NOT IN(SELECT SXDM FROM [E3_001_2019]..SPSX1)
  --款式
   DELETE [E3_001_2019]..SPSX2
   INSERT INTO [E3_001_2019]..SPSX2(SXDM,SXMC)
   SELECT SXDM,SXMC FROM [E3_001_2018]..SPSX2 WHERE SXDM NOT IN(SELECT SXDM FROM [E3_001_2019]..SPSX2)

 --SPSX3
   DELETE [E3_001_2019]..SPSX3
   INSERT INTO [E3_001_2019]..SPSX3(SXDM,SXMC)
   SELECT SXDM,SXMC FROM [E3_001_2018]..SPSX3 WHERE SXDM NOT IN(SELECT SXDM FROM [E3_001_2019]..SPSX3)
 --SPSX4
   DELETE [E3_001_2019]..SPSX4
   INSERT INTO [E3_001_2019]..SPSX4(SXDM,SXMC)
   SELECT SXDM,SXMC FROM [E3_001_2018]..SPSX4 WHERE SXDM NOT IN(SELECT SXDM FROM [E3_001_2019]..SPSX4)
 --SPSX5
   DELETE [E3_001_2019]..SPSX5
   INSERT INTO [E3_001_2019]..SPSX5(SXDM,SXMC)
   SELECT SXDM,SXMC FROM [E3_001_2018]..SPSX5 WHERE SXDM NOT IN(SELECT SXDM FROM [E3_001_2019]..SPSX5)
 --SPSX6
   DELETE [E3_001_2019]..SPSX6
   INSERT INTO [E3_001_2019]..SPSX6(SXDM,SXMC)
   SELECT SXDM,SXMC FROM [E3_001_2018]..SPSX6 WHERE SXDM NOT IN(SELECT SXDM FROM [E3_001_2019]..SPSX6)

 --SPSX7
   DELETE [E3_001_2019]..SPSX7
   INSERT INTO [E3_001_2019]..SPSX7(SXDM,SXMC)
   SELECT SXDM,SXMC FROM [E3_001_2018]..SPSX7 WHERE SXDM NOT IN(SELECT SXDM FROM [E3_001_2019]..SPSX7)
 --SPSX8
   DELETE [E3_001_2019]..SPSX8
   INSERT INTO [E3_001_2019]..SPSX8(SXDM,SXMC)
   SELECT SXDM,SXMC FROM [E3_001_2018]..SPSX8 WHERE SXDM NOT IN(SELECT SXDM FROM [E3_001_2019]..SPSX8)
 --SPSX9
   DELETE [E3_001_2019]..SPSX9
   INSERT INTO [E3_001_2019]..SPSX9(SXDM,SXMC)
   SELECT SXDM,SXMC FROM [E3_001_2018]..SPSX9 WHERE SXDM NOT IN(SELECT SXDM FROM [E3_001_2019]..SPSX9)
 --SPSX10
   DELETE [E3_001_2019]..SPSX10
   INSERT INTO [E3_001_2019]..SPSX10(SXDM,SXMC)
   SELECT SXDM,SXMC FROM [E3_001_2018]..SPSX10 WHERE SXDM NOT IN(SELECT SXDM FROM [E3_001_2019]..SPSX10)

 ---导入资料
  delete [E3_001_2019]..HPXX
  INSERT INTO [E3_001_2019]..HPXX
  SELECT  * FROM [E3_001_2018]..HPXX
  WHERE HPDM NOT IN(SELECT HPDM FROM [E3_001_2019]..HPXX)
   ---导入颜色
   delete [E3_001_2019]..HPYS
   INSERT INTO [E3_001_2019]..HPYS(HPDM,YSDM)
   SELECT HPDM,YSDM FROM [E3_001_2018]..HPYS
---导入尺码
   delete [E3_001_2019]..hpcm
   INSERT INTO [E3_001_2019]..HPCM(HPDM,CMDM)
   SELECT HPDM,CMDM FROM [E3_001_2018]..HPCM


/********************************销售资料*********************************************/
   ---员工
   delete [E3_001_2019]..YUANGONG
   insert into [E3_001_2019]..YUANGONG
   SELECT *FROM [E3_001_2018]..YUANGONG
   ---供货商
   delete [E3_001_2019]..GHS
   INSERT INTO [E3_001_2019]..GHS
   SELECT * FROM  [E3_001_2018]..GHS
   ---客户
   DELETE [E3_001_2019]..KEHU
   INSERT INTO [E3_001_2019]..KEHU
   SELECT * FROM [E3_001_2018]..KEHU
   ---仓库
   DELETE [E3_001_2019]..CANGKU
   INSERT INTO [E3_001_2019]..CANGKU
   SELECT * FROM [E3_001_2018]..CANGKU
   ---店员
   DELETE [E3_001_2019]..DIANYUAN
   INSERT INTO [E3_001_2019]..DIANYUAN
   SELECT * FROM [E3_001_2018]..DIANYUAN
 /********************************进销存业务单据******************************************/
  DELETE [E3_001_2019]..CGRKDMX
  DELETE [E3_001_2019]..CGRKD
  DELETE [E3_001_2019]..CGCKDMX
  DELETE [E3_001_2019]..CGCKD
  ---入库
   INSERT INTO [E3_001_2019]..CGRKD
   SELECT * FROM [E3_001_2018]..CGRKD  WHERE RQ>='2019-01-01'
   INSERT INTO [E3_001_2019]..CGRKDMX
   SELECT  * FROM [E3_001_2018]..CGRKDMX WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..CGRKD)
   ---退货
   INSERT INTO [E3_001_2019]..CGCKD
   SELECT *  FROM [E3_001_2018]..CGCKD WHERE RQ>='2019-01-01'
   INSERT INTO [E3_001_2019]..CGCKDMX
   SELECT * FROM [E3_001_2018]..CGCKDMX  WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..CGCKD)
  ---调拨
   DELETE [E3_001_2019]..SPDBDmx
   DELETE [E3_001_2019]..SPDBD
   DELETE [E3_001_2019]..SPDBTmx
   DELETE [E3_001_2019]..SPDBT
   INSERT INTO [E3_001_2019]..SPDBD
   SELECT * FROM [E3_001_2018]..SPDBD WHERE SHRQ>='2019-01-01' OR YSRQ>='2019-01-01'
   INSERT INTO [E3_001_2019]..SPDBDMX
   SELECT * FROM [E3_001_2018]..SPDBDMX  WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..SPDBD)
   ---调拨退
   INSERT INTO [E3_001_2019]..SPDBT
   SELECT * FROM [E3_001_2018]..SPDBT  WHERE SHRQ>='2019-01-01' OR YSRQ>='2019-01-01'
   INSERT INTO [E3_001_2019]..SPDBTMX
   SELECT * FROM [E3_001_2018]..SPDBTMX  WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..SPDBT)
   ---零售单
   DELETE [E3_001_2019]..QTLSDMX
   DELETE [E3_001_2019]..QTLSD
   INSERT INTO [E3_001_2019]..QTLSD
   SELECT * FROM [E3_001_2018]..QTLSD  WHERE RQ>='2019-01-01'
   INSERT INTO [E3_001_2019]..QTLSDMX
   SELECT * FROM [E3_001_2018]..QTLSDMX  WHERE  DJBH IN(SELECT DJBH FROM [E3_001_2019]..QTLSD)
   ---付款单
  DELETE [E3_001_2019]..QTJSD
  INSERT INTO [E3_001_2019]..QTJSD
  SELECT * FROM [E3_001_2018]..QTJSD WHERE  DJBH IN(SELECT DJBH FROM [E3_001_2019]..QTLSD)
   ---仓库调整单
   DELETE [E3_001_2019]..CKTZDMX
   DELETE [E3_001_2019]..CKTZD
   INSERT INTO [E3_001_2019]..CKTZD
   SELECT *  FROM [E3_001_2018]..CKTZD WHERE RQ>='2019-01-01'
   INSERT INTO [E3_001_2019]..CKTZDMX
   SELECT * FROM [E3_001_2018]..CKTZDMX  WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..CKTZD)
   ---仓库移仓单
   DELETE [E3_001_2019]..CKYCDMX
   DELETE [E3_001_2019]..CKYCD
   INSERT INTO [E3_001_2019]..CKYCD
   SELECT * FROM [E3_001_2018]..CKYCD WHERE SHRQ>='2019-01-01' OR YSRQ>='2019-01-01'
   INSERT INTO [E3_001_2019]..CKYCDMX
   SELECT * FROM [E3_001_2018]..CKYCDMX  WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..CKYCD)
   ---批发销货单
   DELETE [E3_001_2019]..PFXHDMX
   DELETE [E3_001_2019]..PFXHD
   INSERT INTO [E3_001_2019]..PFXHD
   SELECT * FROM [E3_001_2018]..PFXHD WHERE SHRQ>='2019-01-01' OR YSRQ>='2019-01-01'
   INSERT INTO [E3_001_2019]..PFXHDMX
   SELECT * FROM [E3_001_2018]..PFXHDMX  WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..PFXHD)
   --批发退货单
   DELETE [E3_001_2019]..PFTHDMX
   DELETE [E3_001_2019]..PFTHD
   INSERT INTO [E3_001_2019]..PFTHD
   SELECT * FROM [E3_001_2018]..PFTHD WHERE SHRQ>='2019-01-01' OR YSRQ>='2019-01-01'
   INSERT INTO [E3_001_2019]..PFTHDMX
   SELECT * FROM [E3_001_2018]..PFTHDMX  WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..PFTHD)

   --CKPDD
   DELETE [E3_001_2019]..CKPDDMX
   DELETE [E3_001_2019]..CKPDD
   INSERT INTO [E3_001_2019]..CKPDD
   SELECT * FROM [E3_001_2018]..CKPDD WHERE RQ>='2019-01-01'
   INSERT INTO [E3_001_2019]..CKPDDMX
   SELECT * FROM [E3_001_2018]..CKPDDMX  WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..CKPDD)
 --CKYKD
   DELETE [E3_001_2019]..CKYKDMX
   DELETE [E3_001_2019]..CKYKD
   INSERT INTO [E3_001_2019]..CKYKD
   SELECT * FROM [E3_001_2018]..CKYKD WHERE RQ>='2019-01-01'
   INSERT INTO [E3_001_2019]..CKYKDMX
   SELECT * FROM [E3_001_2018]..CKYKDMX  WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..CKYKD) AND (SL<>0 OR SL1<>0)


 /********************************客户往来业务单据******************************************/
  --应收款调整单
  DELETE [E3_001_2019]..YSKTZD
  INSERT INTO [E3_001_2019]..YSKTZD
  SELECT * FROM [E3_001_2018]..YSKTZD WHERE RQ>='2019-01-01'
  --应付款
  DELETE [E3_001_2019]..YFKTZD
  INSERT INTO [E3_001_2019]..YFKTZD
  SELECT * FROM [E3_001_2018]..YFKTZD WHERE RQ>='2019-01-01'
  --收款单
  DELETE [E3_001_2019]..KHSKD
  INSERT INTO [E3_001_2019]..KHSKD
  SELECT * FROM [E3_001_2018]..KHSKD WHERE RQ>='2019-01-01'
  INSERT INTO [E3_001_2019]..KHSKDMX
  SELECT * FROM [E3_001_2018]..KHSKDMX WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..KHSKD)
  --付款单
  DELETE [E3_001_2019]..GHSFKDMX
  DELETE [E3_001_2019]..GHSFKDMX1
  DELETE [E3_001_2019]..GHSFKD
  INSERT INTO [E3_001_2019]..GHSFKD
  SELECT * FROM [E3_001_2018]..GHSFKD WHERE RQ>='2019-01-01'
  INSERT INTO [E3_001_2019]..GHSFKDMX
  SELECT * FROM [E3_001_2018]..GHSFKDMX WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..GHSFKD)
  INSERT INTO [E3_001_2019]..GHSFKDMX1
  SELECT * FROM [E3_001_2018]..GHSFKDMX1 WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..GHSFKD)

  DELETE [E3_001_2019]..KHCKTZD
  INSERT INTO [E3_001_2019]..KHCKTZD
  SELECT * FROM [E3_001_2018]..KHCKTZD WHERE RQ>='2019-01-01'

  DELETE [E3_001_2019]..XSFYD
  INSERT INTO [E3_001_2019]..XSFYD
  SELECT * FROM [E3_001_2018]..XSFYD WHERE RQ>='2019-01-01'
  INSERT INTO [E3_001_2019]..XSFYDMX
  SELECT * FROM [E3_001_2018]..XSFYDMX WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..XSFYD)
  INSERT INTO [E3_001_2019]..XSFYDMX1
  SELECT * FROM [E3_001_2018]..XSFYDMX1 WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..XSFYD)

  DELETE [E3_001_2019]..KHCKD
  INSERT INTO [E3_001_2019]..KHCKD
  SELECT * FROM [E3_001_2018]..KHCKD WHERE RQ>='2019-01-01'

  DELETE [E3_001_2019]..YHJLB
  INSERT INTO [E3_001_2019]..YHJLB
  SELECT * FROM [E3_001_2018]..YHJLB WHERE RQ>='2019-01-01'

  DELETE [E3_001_2019]..KHFYDMX
  DELETE [E3_001_2019]..KHFYD
  INSERT INTO [E3_001_2019]..KHFYD
  SELECT * FROM [E3_001_2018]..KHFYD WHERE RQ>='2019-01-01'
  INSERT INTO [E3_001_2019]..KHFYDMX
  SELECT * FROM [E3_001_2018]..KHFYDMX WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..KHFYD)


  DELETE [E3_001_2019]..XSFYDMX
  DELETE [E3_001_2019]..XSFYDMX1
  DELETE [E3_001_2019]..XSFYD
  INSERT INTO [E3_001_2019]..XSFYD
  SELECT * FROM [E3_001_2018]..XSFYD WHERE RQ>='2019-01-01'
  INSERT INTO [E3_001_2019]..XSFYDMX
  SELECT * FROM [E3_001_2018]..XSFYDMX WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..XSFYD)
  INSERT INTO [E3_001_2019]..XSFYDMX1
  SELECT * FROM [E3_001_2018]..XSFYDMX1 WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..XSFYD)


  --费用单 未写入脚本
 /********************************会员资料单据******************************************/
  --1自行建立会员类别，然后再导入会员资料
  DELETE [E3_001_2019]..VIPSET
  INSERT INTO [E3_001_2019]..VIPSET
  SELECT * FROM  [E3_001_2018]..VIPSET  WHERE VIPDM NOT IN(SELECT VIPDM FROM [E3_001_2019]..VIPSET )
  --2会员积分调整单
  DELETE [E3_001_2019]..VIPJFTZD
  INSERT INTO [E3_001_2019]..VIPJFTZD
  SELECT * FROM [E3_001_2018]..VIPJFTZD WHERE RQ>='2019-01-01'
  --3会员储值单
  DELETE [E3_001_2019]..VIPCZDMX
  DELETE [E3_001_2019]..VIPCZD
  INSERT INTO [E3_001_2019]..VIPCZD(DJBH,VIPDM,RQ,YDBH,TZLX,CZJE,ZDR,ZDRQ,YSH,SHR,SHRQ,JZRQ,JZR,BZ,YJZ,ZSJE,SJJE,KHDM,DYDM,ZSJF,BYZD1,BYZD2)
  SELECT DJBH,VIPDM,RQ,YDBH,TZLX,CZJE,ZDR,ZDRQ,YSH,SHR,SHRQ,JZRQ,JZR,BZ,YJZ,ZSJE,SJJE,KHDM,DYDM,ZSJF,BYZD1,BYZD2 FROM [E3_001_2018]..VIPCZD WHERE RQ>='2019-01-01'
  INSERT INTO [E3_001_2019]..VIPCZDMX
  SELECT * FROM [E3_001_2018]..VIPCZDMX WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..VIPCZD)
  --SPTJD
  DELETE [E3_001_2019]..SPTJDMX
  DELETE [E3_001_2019]..SPTJDMX1
  DELETE [E3_001_2019]..SPTJD
  INSERT INTO [E3_001_2019]..SPTJD
  SELECT * FROM [E3_001_2018]..SPTJD WHERE RQ>='2019-01-01'
  INSERT INTO [E3_001_2019]..SPTJDMX
  SELECT * FROM [E3_001_2018]..SPTJDMX WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..SPTJD)
  INSERT INTO [E3_001_2019]..SPTJDMX1
  SELECT * FROM [E3_001_2018]..SPTJDMX1 WHERE DJBH IN(SELECT DJBH FROM [E3_001_2019]..SPTJD)
  --VIPJFTZD
  INSERT INTO [E3_001_2019]..VIPJFTZD(DJBH,RQ,KHDM,VIPDM,TZLX,TZJF,YSH,BZ)
  SELECT  'VT100120180531'+CONVERT(VARCHAR, ROW_NUMBER() over(order by VIPDM)),'2018-12-31','1001',VIPDM,'期初转接',JFS=SUM(JFS),1,'期初转接' FROM  [E3_001_2018]..VW_VIPJFJLB WHERE YSH=1 AND RQ<'2019-01-01'   GROUP BY VIPDM HAVING SUM(JFS)<>0
  --储值调整单
  DELETE [E3_001_2019]..VIPCZTZD
  INSERT INTO [E3_001_2019]..VIPCZTZD(DJBH,RQ,VIPDM,KHDM,DYDM,LX,JE,YJE,YDBH,ZDR,ZDRQ,YSH,SHR,SHRQ)
  SELECT DJBH,RQ,VIPDM,KHDM,DYDM,LX,JE,YJE,YDBH,ZDR,ZDRQ,YSH,SHR,SHRQ FROM [E3_001_2018]..VIPCZTZD WHERE RQ>='2019-01-01'
  INSERT INTO [E3_001_2019]..VIPCZTZD(DJBH,RQ,VIPDM,KHDM,DYDM,LX,JE,YDBH,ZDR,ZDRQ,YSH,SHR,SHRQ)
  SELECT  'VT100120180531'+CONVERT(VARCHAR, ROW_NUMBER() over(order by VIPDM)),'2018-12-31','1001',VIPDM,'','期初转接',SJJE=SUM(SJJE),'','SA',GETDATE(),1,'SA',GETDATE() FROM  [E3_001_2018]..VW_VIPCZJLB WHERE YSH=1 AND RQ<'2019-01-01'   GROUP BY VIPDM HAVING SUM(SJJE)<>0
--生成库存调整1


select * into #TEMP_CKXX from [E3_001_2019]..CANGKU
declare @CKDM varchar(20);
declare @SQL varchar(2000);
declare @DJBH varchar(20);
declare @LSBH INT;
SET @LSBH=1
while (exists(select CKDM from [E3_001_2019]..#TEMP_CKXX))
begin
     select @CKDM=CKDM from [E3_001_2019]..#TEMP_CKXX
      SET @LSBH=@LSBH+1
      SET @DJBH='TZ20181231100'+convert(varchar,@LSBH)
      SET @SQL=' INSERT INTO [E3_001_2019]..CKTZD(DJBH,RQ,CKDM,ZK,ZDR,ZDRQ,YSH,SHR,SHRQ,JG,BZ)'
      SET @SQL=@SQL+' VALUES('''+@DJBH+''',''2018-12-31'','''+@CKDM+''',1,''SA'',GETDATE(),1,''SA'',getdate(),''SJ'',''期初导入'')'
       EXEC(@SQL)
     SET @SQL=' INSERT INTO [E3_001_2019]..CKTZDMX(DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE)'
     SET @SQL=@SQL+'  SELECT  '''+@DJBH+''',MXBH=ROW_NUMBER() over(order by A.HPDM),A.HPDM,HPYS,HPCM,SL=SUM(-SL),A.SJ,1,A.SJ,SUM(-SL)*A.SJ  FROM [E3_001_2019]..VW_CKJXCMX B,[E3_001_2019]..HPXX A WHERE A.HPDM=B.HPDM  AND ISNULL(YSH,0)=1 AND CKDM='''+@CKDM+''' AND RQ<''2019-01-01'' GROUP BY A.HPDM,HPYS,HPCM,A.SJ HAVING SUM(SL)<>0'
     EXEC(@SQL)
     PRINT(@SQL)
     SET @SQL='  UPDATE A SET A.SL=B.SL,A.JE=B.JE FROM [E3_001_2019]..CKTZD A,(SELECT DJBH,SL=SUM(SL),JE=SUM(JE) FROM [E3_001_2019]..CKTZDMX  WHERE  DJBH='''+@DJBH+''' GROUP BY DJBH) B WHERE A.DJBH=B.DJBH   '
  EXEC(@SQL)
     delete [E3_001_2018]..#TEMP_CKXX where CKDM=@CKDM
end
drop table [E3_001_2018]..#TEMP_CKXX
--生成库存调整2
select * into #TEMP_CKXX from [E3_001_2018]..CANGKU
declare @CKDM varchar(20);
declare @SQL varchar(2000);
declare @DJBH varchar(20);
declare @LSBH INT;
SET @LSBH=1
while (exists(select CKDM from [E3_001_2018]..#TEMP_CKXX))
begin
     select @CKDM=CKDM from [E3_001_2018]..#TEMP_CKXX
      SET @LSBH=@LSBH+1
      SET @DJBH='TZ2018053100'+convert(varchar,@LSBH)
      SET @SQL=' INSERT INTO [E3_001_2019]..CKTZD(DJBH,RQ,CKDM,ZK,ZDR,ZDRQ,YSH,SHR,SHRQ,JG,BZ)'
      SET @SQL=@SQL+' VALUES('''+@DJBH+''',''2018-12-31'','''+@CKDM+''',1,''SA'',GETDATE(),1,''SA'',getdate(),''SJ'',''期初导入'')'
       EXEC(@SQL)
     SET @SQL=' INSERT INTO [E3_001_2019]..CKTZDMX(DJBH,MXBH,HPDM,HPYS,HPCM,SL,DJ,ZK,SJDJ,JE)'
     SET @SQL=@SQL+'  SELECT  '''+@DJBH+''',MXBH=ROW_NUMBER() over(order by A.HPDM),A.HPDM,HPYS,HPCM,SL=SUM(SL),A.SJ,1,A.SJ,SUM(SL)*A.SJ  FROM [E3_001_2018]..VW_CKJXCMX B,[E3_001_2018]..HPXX A WHERE A.HPDM=B.HPDM  AND ISNULL(YSH,0)=1 AND CKDM='''+@CKDM+''' AND RQ<''2019-01-01'' GROUP BY A.HPDM,HPYS,HPCM,A.SJ HAVING SUM(SL)<>0'
     EXEC(@SQL)
     SET @SQL='  UPDATE A SET A.SL=B.SL,A.JE=B.JE FROM [E3_001_2019]..CKTZD A,(SELECT DJBH,SL=SUM(SL),JE=SUM(JE) FROM [E3_001_2019]..CKTZDMX  WHERE  DJBH='''+@DJBH+''' GROUP BY DJBH) B WHERE A.DJBH=B.DJBH   '
  EXEC(@SQL)
     delete [E3_001_2018]..#TEMP_CKXX where CKDM=@CKDM
end
drop table [E3_001_2018]..#TEMP_CKXX


--生成应付款调整
 INSERT INTO [E3_001_2019]..YFKTZD( DJBH,QDDM,GHSDM,RQ,TZLX,JE,ZDR,ZDRQ,YJZ,JZRQ,JZR,BYZD1)
  SELECT  'YF100120180531'+CONVERT(VARCHAR, ROW_NUMBER() over(order by GHSDM)),'000',GHSDM,'2018-12-31','期初转接',JE=SUM(JE-FKJE+TZJE),'SA',GETDATE(),1,GETDATE(),'SA','期初转接'
 FROM  [E3_001_2018]..VW_GHSDZD WHERE YJZ=1 AND RQ<'2019-01-01'   GROUP BY GHSDM HAVING SUM(JE-FKJE+TZJE)<>0
--生成应收款调整此处暂时没有实现
---生成存款数据
 INSERT INTO [E3_001_2019]..KHCKTZD( DJBH,KHDM,RQ,TZJE,ZDR,ZDRQ,BZ,YSH,SHR,SHRQ,YJZ,JZR,JZRQ)
  SELECT 'CT20180531'+CONVERT(VARCHAR, ROW_NUMBER() over(order by KHDM)), KHDM,'2018-12-31', JE=SUM(XSJE-CKJE+TZJE-FYJE+CZJE),'SA',getdate(),'期初转接',1,'sa',getdate(),1,'sa',getdate() FROM [E3_001_2018]..VW_CKJLB WHERE   RQ<'2019-01-01' GROUP BY KHDM
--- 现金银行转账记录尚未实现

--清理不存在进销存记录的商品资料
DELETE  FROM  [E3_001_2019]..SPTJDMX WHERE HPDM NOT IN(SELECT  DISTINCT HPDM FROM [E3_001_2019]..VW_CKJXCMX)
DELETE  FROM  [E3_001_2019]..HPYS WHERE HPDM NOT IN(SELECT  DISTINCT HPDM FROM [E3_001_2019]..VW_CKJXCMX)
DELETE  FROM  [E3_001_2019]..HPCM WHERE HPDM NOT IN(SELECT  DISTINCT HPDM FROM [E3_001_2019]..VW_CKJXCMX)
DELETE  FROM  [E3_001_2019]..HPXX WHERE HPDM NOT IN(
SELECT  DISTINCT HPDM FROM [E3_001_2019]..VW_CKJXCMX  )

DELETE    [E3_001_2019]..HPXX WHERE HPDM NOT IN( select hpdm from #temp_hpxx)

DELETE  FROM  [E3_001_2019]..HPXX WHERE HPDM NOT IN(
SELECT  DISTINCT HPDM  INTO #temp_hpxx FROM [E3_001_2019]..VW_CKJXCMX  )

 SELECT  COUNT(*) FROM [E3_001_2019]..HPXX

SELECT  COUNT(*) FROM [E3_001_2018]..HPXX
 SELECT  COUNT(*)  FROM (
SELECT  DISTINCT HPDM FROM [E3_001_2019]..VW_CKJXCMX
 UNION ALL SELECT DISTINCT HPDM    FROM [E3_001_2019]..CKYKDMX
)A

 DELETE [E3_001_2019]..CKYKDmx
DELETE [E3_001_2019]..CKYKDmx


 --exec [E3_001_2019]..P_CreateKcwf ''
 --exec [E3_001_2018]..P_CreateKcwf ''

 --exec [E3_001_2019]..P_CreateGhswf
 --exec [E3_001_2018]..P_CreateGhswf
```

## 7. MS 清空数据库资料

```
--CG
DELETE FROM CGRKDMX
DELETE FROM CGRKD
DELETE FROM CGCKDMX
DELETE FROM CGCKD
DELETE FROM CGRDDMX
DELETE FROM CGRDD
--DB
DELETE FROM SPDBDMX
DELETE FROM SPDBD
DELETE FROM SPDBTMX
DELETE FROM SPDBT
--PF
DELETE FROM PFTHDMX
DELETE FROM PFTHD
DELETE FROM PFXHDMX
DELETE FROM PFXHD
DELETE FROM PFDMX
DELETE FROM PFD
DELETE FROM PFTDDMX
DELETE FROM PFTDD
DELETE FROM PFTDMX
DELETE FROM PFTD
DELETE FROM PFXDDMX
DELETE FROM PFXDD
--LS
DELETE FROM LSFKD
DELETE FROM LSXHDMX
DELETE FROM LSXHD
--KC
DELETE FROM CKYKDMX
DELETE FROM CKYKD
DELETE FROM CKTZDMX
DELETE FROM CKTZD
DELETE FROM CKPDDMX
DELETE FROM CKPDD
--GHS
DELETE FROM YSKTZD
DELETE FROM YFKTZD
DELETE FROM GHSFKD
DELETE FROM KHSKD
DELETE FROM XHFYD
DELETE FROM GHSYF
DELETE FROM KHYS

--KCWF
EXEC P_HPKCB
EXEC P_HPKCB ''
--KH
DELETE FROM CANGKU
DELETE FROM KEHU
DELETE FROM HPYS
DELETE FROM HPCM
DELETE FROM YANSE
DELETE FROM CHIMAZUMX
DELETE FROM CHIMAZU
DELETE FROM CHIMA
DELETE FROM HPXX
DELETE FROM GHS
```

## 8. 系统更新功能语句

```
--会员付费券统计
INSERT [SYS_GNMK] ([MkID],[MkName],[ParentID],[IsMk],[IsVisble]) VALUES ( N'M0004015',N'会员付费券统计',N'M0004',1,1)
INSERT [SYS_GNMK] ([MkID],[MkName],[ParentID],[IsMk],[IsVisble]) VALUES ( N'M000401509',N'打印',N'M0004015',0,1)
INSERT [SYS_GNMK] ([MkID],[MkName],[ParentID],[IsMk],[IsVisble]) VALUES ( N'M000401510',N'导出',N'M0004015',0,1)

--门店补货统计
INSERT [SYS_GNMK] ([MkID],[MkName],[ParentID],[IsMk],[IsVisble]) VALUES ( N'G00319',N'门店补货统计',N'G003',1,1)
INSERT [SYS_GNMK] ([MkID],[MkName],[ParentID],[IsMk],[IsVisble]) VALUES ( N'G00319008',N'浏览',N'G00319',0,1)
INSERT [SYS_GNMK] ([MkID],[MkName],[ParentID],[IsMk],[IsVisble]) VALUES ( N'G00319009',N'打印',N'G00319',0,1)
INSERT [SYS_GNMK] ([MkID],[MkName],[ParentID],[IsMk],[IsVisble]) VALUES ( N'G00319010',N'导出',N'G00319',0,1)

--会员消费占比统计
  if  not exists (select * from SYS_GNMK where mkid ='M0002005' )
begin
INSERT [SYS_GNMK] ([MkID],[MkName],[ParentID],[IsMk],[IsVisble]) VALUES ( N'M0004013',N'会员消费占比统计',N'M0004',1,1)
INSERT [SYS_GNMK] ([MkID],[MkName],[ParentID],[IsMk],[IsVisble]) VALUES ( N'M000401309',N'打印',N'M0004013',0,1)
INSERT [SYS_GNMK] ([MkID],[MkName],[ParentID],[IsMk],[IsVisble]) VALUES ( N'M000401310',N'导出',N'M0004013',0,1)
END
GO
```

## 9. 修改会计月度

```
--修改会计月度
update System_GnSet SET GNVALUE='2023-05' WHERE GNID='KJ0001'
```

## 10. 导入会员资料，导入积分调整单

```
--修改手机空值
UPDATE DDVIP SET 手机=会员代码 where 手机=''

UPDATE DDVIP SET 会员等级=a.lbdm from VIPLB as a  where a.LBMC=会员等级

UPDATE DDVIP SET 店铺=a.khdm from KEHU  as a  where a.khmc=店铺

INSERT INTO VIPSET (VIPDM,VIPMC,CSRQ,SJBH,GLSD,CJR,CJRQ,LJJF,DQJF,LJXFJE,DQJE,LBDM,QY,QYRQ,QYR,PWD,VIPPWD,SEX)
SELECT 会员代码,会员名称,'1949-01-01',手机,店铺,'sa',GETDATE(),积分,积分,积分,0,
会员等级,1,GETDATE(),'sa',0,null,null,'888888','888888',1 from ddvip
--3、修改积分调整的ydbh

insert into vipset (VIPDM,VIPMC,CSRQ,SJBH,GLSD,CJR,CJRQ,LJJF,DQJF,LJXFJE,DQJE,LBDM,QY,QYRQ,QYR,PWD,VIPPWD,SEX)
select sjbh,vipmc,'2000-01-01',sjbh,glsd,'sa',getdate(),0,0,0,czje,'000',1,'sa'getdate(),'888888','888888',0 from sf2$ where sjbh not in(select sjbh from vipset)

--添加储值调整单
insert into vipcztzd(djbh,mxbh,rq,vipdm,khdm,dydm,lx,je,yje,ydbh,bz,zdr,zdrq,ysh,shrq,shr)
select 'VT'+GLSD+'230701'+right(cast('10000' as varchar)+ROW_NUMBER() OVER (ORDER BY NEWID()),4) AS DJBH,ROW_NUMBER() OVER (ORDER BY NEWID()) as mxbh,'2023-07-01',
VIPDM,GLSD,'','会员金额期初调整',czje,0,'','','sa','2023-07-01',1,'2023-07-01','sa'
from sf2$

INSERT INTO VIPJFTZD(DJBH,VIPDM,RQ,YDBH,TZLX,YJF,TZJF,ZDR,ZDRQ,YSH,SHR,SHRQ,KHDM,BZ)
SELECT 'JF'+right(cast('10000000000' as varchar)+ROW_NUMBER() OVER (ORDER BY NEWID()),10) AS DJBH,
a.VIPDM,'2023-08-17','','期初调整',0,a.DQJF,'SA',GETDATE(),1,'SA',GETDATE(),A.GLSD,A.BZ from VIPSET as a
WHERE A.DQJF!=0SQL
```

## 11. 去掉空格

```
REPLACE(csrq,'          ','')
```

## 12. 控制店铺积分

```
/****** Object:  StoredProcedure [dbo].[P_GetVIPJF1]    Script Date: 04/26/2022 14:25:58 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROC [dbo].[P_GetVIPJF1]
(
@KHDM Nvarchar(20), --店铺代码
@VIPDM Nvarchar(20), --会员代码
@XSJE decimal(18, 2) --消费
)
AS
DECLARE
@JF INT,                --积分
@JFBL INT,                --比例
@SRJFBL INT            --生日积分倍数
DECLARE  @LBDM varchar(20)
SET @LBDM=(SELECT LBDM FROM VIPSET WHERE VIPDM=@VIPDM)
/*启用PLUS*/
DECLARE  @PLUS BIT
SELECT @PLUS=ISNULL(Plus_Enable,0) FROM VIPLB WHERE LBDM=@LBDM
IF(@PLUS=1)
BEGIN
SET @PLUS=( SELECT 1 FROM VIPSET WHERE PLUS_END_TIME>GETDATE() AND VIPDM=@VIPDM)
IF(@PLUS IS NULL)
BEGIN
SET @PLUS=0
END
IF(@PLUS=1)
begin
goto vipplus
end
else
begin
goto vip
end
END
ELSE
BEGIN
goto vip
END
vip:
select @JFBL=JFBL,@SRJFBL=SRJFBL FROM VIPLB WHERE LBDM=@LBDM
Goto theEnd
vipplus:
select @JFBL=Plus_Jfbl,@SRJFBL=Plus_Srjfbl FROM VIPLB WHERE LBDM=@LBDM
Goto theEnd
theEnd:
DECLARE  @RQ_S DATETIME
DECLARE  @RQ_E DATETIME
DECLARE  @RQ_SS varchar(20)
DECLARE  @RQ_ES varchar(20)
SET @RQ_S=CONVERT(VARCHAR(10),DATEADD(DAY,-3,GETDATE()),120)
SET @RQ_E=CONVERT(VARCHAR(10),DATEADD(DAY,3,GETDATE()),120)
SET  @RQ_SS=CONVERT(VARCHAR(10),@RQ_S,120)
SET  @RQ_ES=CONVERT(VARCHAR(10),@RQ_E,120)
DECLARE  @SR_ENABLE  BIT
SET @SR_ENABLE=0
SET @SR_ENABLE=(SELECT 1 FROM VW_VIPSET  WHERE  VIPDM=@VIPDM AND (DATEADD(Year,DATEDIFF(Year,csrq,''+@RQ_SS+''),csrq) BETWEEN ''+@RQ_SS+'' AND ''+@RQ_ES+''   OR DATEADD(Year,DATEDIFF(Year,csrq,''+@RQ_ES+''),csrq)  BETWEEN ''+@RQ_SS+'' AND ''+@RQ_ES+''))
IF(@SR_ENABLE IS NULL)
BEGIN
SET @SR_ENABLE=0
END
IF(@SR_ENABLE=0)
BEGIN
SET @SRJFBL=1
END
IF(@JFBL!=0)
BEGIN
SET @JF=@XSJE/@JFBL
END
ELSE
BEGIN
SET @JF=0
END
IF(@SRJFBL IS NULL)
BEGIN
SET  @SRJFBL=1
END
IF(@SRJFBL=0)
BEGIN
SET  @SRJFBL=1
END
---根据客户代码进行及判断脚本
IF(@KHDM='031')
BEGIN
SET @SRJFBL=2
END
IF(@KHDM='050')
BEGIN
SET @SRJFBL=2
END
IF(@KHDM='059')
BEGIN
SET @SRJFBL=2
END
IF(@KHDM='044')
BEGIN
SET @SRJFBL=2
END
IF(@KHDM='035')
BEGIN
SET @SRJFBL=2
END
SET @JF=@JF*@SRJFBL
SELECT @JF AS JF
GO
```

## 13. MS 删除店铺所有单据

```
--删除采购
DELETE FROM CGRKDMX
DELETE FROM CGRKD
DELETE FROM CGCKDMX
DELETE FROM CGCKD
DELETE FROM CGRDDMX
DELETE FROM CGRDD
--删除调拨
DELETE FROM SPDBDMX
DELETE FROM SPDBD
DELETE FROM SPDBTMX
DELETE FROM SPDBT
--删除批发
DELETE FROM PFTHDMX
DELETE FROM PFTHD
DELETE FROM PFXHDMX
DELETE FROM PFXHD
--删除零售
DELETE FROM LSFKD
DELETE FROM LSXHDMX
DELETE FROM LSXHD
DELETE FROM SPBHDMX
DELETE FROM SPBHD
DELETE FROM SPTJDMX1
DELETE FROM SPTJDMX
DELETE FROM SPTJD
--删除库存
DELETE FROM CKYKDMX
DELETE FROM CKYKD
DELETE FROM CKTZDMX
DELETE FROM CKTZD
DELETE FROM CKPDDMX
DELETE FROM CKPDD
--删除财务
DELETE FROM GHSFKD
DELETE FROM KHSKD
DELETE FROM YFKTZD
DELETE FROM YSKTZD
DELETE FROM XHFYD
DELETE FROM XSRBB
DELETE FROM YHZTD
DELETE FROM KHYS
DELETE FROM KHTJDMX
DELETE FROM KHTJDMX1
DELETE FROM KHTJD
--删除商品
DELETE FROM HPYS
DELETE FROM HPCM
DELETE FROM HPXX

EXEC P_HPKCB
```

## 14. 添加 APP 设备管理功能

```
INSERT [SYS_GNMK] ([MkID],[MkName],[ParentID],[IsMk],[IsVisble]) VALUES ( N'Z00024',N'APP设备管理',N'Z00',1,1)

insert into System_GnSet(GNID,GNMS,GNVALUE)
values('appusers','app','qjmy')
```

## 15. APP 后台权限

```
/****** Object:  StoredProcedure [dbo].[P_CREATE_E3APP_GNMK]    Script Date: 11/09/2023 15:29:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER  PROC [dbo].[P_CREATE_E3APP_GNMK]
AS
delete SYS_1GNMK
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('000','APP系统','-1',1,1,'','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000','常规菜单','000',1,1,'','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000001','商品','0000',1,1,'/pages/base/goods/list','icon-yifu color-red')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000001001','修改','0000001',0,1,'','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000001002','查看','0000001',0,1,'','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000002','采购','0000',1,1,'/pages/cg/list','icon-caigou color-red')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000003','调拨','0000',1,1,'/pages/db/list','icon-kucun color-red')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000004','批发','0000',1,1,'/pages/pf/list','icon-kucun color-red')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000005','零售','0000',1,1,'/pages/ls/list','icon-kucun color-red')
 insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000005001','前台零售单(仓库)','0000005',1,1,'/pages/ls/qtlsd_detail','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000005002','前台零售单(门店)','0000005',1,1,'/pages/ls/qtlsd_detail_all','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000005003','小票列表','0000005',1,1,'/pages/ls/lslist','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000005004','零售统计(商品)','0000005',1,1,'/pages/ls/bb/lstj_goods','')
 insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000006','条码打印','0000',1,1,'/pages/bc/print_barcode','icon-kucun color-red')
 insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000007','门店补货单','0000',1,1,'/pages/ls/sdbhd_list','icon-kucun color-red')
 insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000008','仓库管理','0000',1,1,'/pages/ck/list','icon-kucun color-red')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000008001','仓库盘点单','0000008',1,1,'/pages/ck/ckpdd_list','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000008002','仓库盈亏单','0000008',1,1,'/pages/ck/ckykd_list','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000008003','仓库调整单(正常)','0000008',1,1,'/pages/ck/cktzd_list?style=1','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000008004','仓库调整单(返厂)','0000008',1,1,'/pages/ck/cktzd_list?style=2','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000008005','仓库调整单(报废)','0000008',1,1,'/pages/ck/cktzd_list?style=3','')
    insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0002','报表','000',1,1,'','')
 insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0002001','库存统计(商品)','0002',1,1,'/pages/bb/kctj','icon-kucun color-red')
 insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0002002','库存统计(仓库)','0002',1,1,'/pages/bb/kctj_ck','icon-kucun color-red')
 insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0002003','调拨统计','0002',1,1,'/pages/bb/dbtj','icon-kucun color-red')
 insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0002004','查询款调拨记录','0002',1,1,'/pages/bb/dbsend','icon-kucun color-red')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('00009','参数','0000',1,0,'','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('00009001','标签打印设置','00009',1,0,'/pages/sys/print/barcodeprint','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('00009002','商品档案设置','00009',1,0,'/pages/sys/set/goodsset','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('00009003','扫描枪设置','00009',1,0,'/pages/sys/scanbarcode','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('00009004','小票打印设置','00009',1,0,'/pages/sys/set/xpset/xpset','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('00009005','调拨票据打印设置','00009',1,0,'/pages/sys/set/xpset/dbset','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('00009006','批发票据打印设置','00009',1,0,'/pages/sys/set/xpset/pfset','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('00009007','打印机速度设置','00009',1,0,'/pages/sys/set/xpset/printerset','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('00009008','仓库供货商设置','00009',1,0,'/pages/sys/set/cangkuset','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('00009009','商品缓存设置','00009',1,0,'/pages/sys/set/goodscache','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('00009010','标记清空','00009',1,0,'/pages/sys/djbjqk','')
insert into SYS_1GNMK(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('00009011','库存维护','00009',1,0,'/pages/sys/kcwh','')
GO
```

## 16. APP 店铺权限脚本

```
/****** Object:  StoredProcedure [dbo].[P_CREATE_POSAPP_GNMK]    Script Date: 11/09/2023 15:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROC [dbo].[P_CREATE_POSAPP_GNMK]
AS
delete SYS_POS1_GNMK
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('000','POS系统','-1',1,1,'','')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000','零售管理','000',1,1,'','')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000001','零售单','0000',1,1,'/pages/ls/detail','icon-tubiao-1 color-red')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000002','小票列表','0000',1,1,'/pages/ls/list','icon-jichuxinxi color-red')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000003','小票作废','0000',1,1,'/pages/ls/qtlsd_zuofei','icon-jichushujuguanli color-red')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000004','店员','0000',1,1,'/pages/ls/dy_list','icon-jichushujuguanli color-red')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000006','跨店小票作废','0000',1,1,'/pages/ls/qtlsd_zuofei_othershop','icon-jichushujuguanli color-red')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0000005','报表','0000',1,1,'/pages/ls/bb/list','icon-bb color-blue')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0001','会员管理','000',1,1,'','')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0001001','会员','0001',1,1,'/pages/vip/list','icon-huiyuan color-red')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0001002','报表','0001',1,1,'/pages/vip/bb/list','icon-bb color-blue')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0003','库存管理','000',1,1,'','')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0003001','收货单','0003',1,1,'/pages/ck/sdshd/sdshd','icon-xinpin color-red')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0003002','调拨单','0003',1,1,'/pages/ck/sddbd/sddbd','icon-kucun color-red')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0003003','盘点单','0003',1,1,'/pages/ck/ckpdd/ckpdd','icon-kucunchaxun color-red')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0003004','盈亏单','0003',1,1,'/pages/ck/ckykd/list','icon-kucunchaxun color-red')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0003005','补货单','0003',1,1,'/pages/ck/sdbhd/sdbhd','icon-kucun color-red')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0003006','报表','0003',1,1,'/pages/ck/bb/list','icon-bb color-blue')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0009','参数','000',1,0,'','')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0009001','小票打印设置','0009',1,0,'/pages/sys/gnset/xpset/xpset','')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0009002','蓝牙扫描枪设置','0009',1,0,'/pages/sys/gnset/scanbarcode','')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0009003','修改登录密码','0009',1,0,'/pages/sys/gnset/modifpwd','')
insert into sys_pos1_gnmk(mkid,mkname,parentid,ismk,isvisble,path,icon)
values('0009004','修改查询密码','0009',1,0,'/pages/sys/gnset/modifpwd1','')
GO
```
